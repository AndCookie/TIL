<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.kd.cashbook.dao.CashbookMapper">
	<!-- 지출 항목 조회 -->
	<select id="selectCashItem" resultType="CashItem">
	SELECT itemid, itemname
	FROM cashitems
	ORDER BY itemname
	</select>
	
	<!-- 지출 내역 저장 -->
	<insert id = "insertCashbook" parameterType = "Cashbook">
	INSERT INTO cashbook
	(seq, dates, itemid, detail, amount, note)
	VALUES
	(cashbook_seq.NEXTVAL, #{dates}, #{itemid}, #{detail}, #{amount}, #{note})
	</insert>

	<!-- 연도/월별 조회  -->
	<select id="ReadCashbookByDate" parameterType = "String" resultType="Cashbook">
	SELECT seq, dates, detail, amount, note
	FROM cashbook
	WHERE dates LIKE 'SUBSTR(#{dates}, 1, 5)/%'
	</select>
	
	<!-- 내역 삭제 -->
	<delete id="deleteCashbook" parameterType="Int">
	DELETE cashbook
	WHERE seq = #{seq}
	</delete>
	
	<!-- 월별 지출 통계보기 -->
	<select id="statatics" parameterType = "String" resultType="TotalAmount">
	SELECT *
	FROM cashbook cb JOIN cashitem ci
	USING (itemid)
	ORDER BY 1
	</select>
</mapper>